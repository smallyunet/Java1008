## Day09

### 自定义函数

#### 什么是自定义函数

Oracle中的自定义函数实际是一组PL/SQL的语句的组合。它也是一种存储在数据库中的命名程序块，也被称为存储函数。

函数一般用于计算和返回一个值，可以将经常需要使用的计算或功能写成一个函数。

函数可以接受零个或多个输入参数，并且函数必须有返回值。

#### 函数的创建及使用

创建的语法：

    CREATE [OR REPLACE] FUNCTION 函数名（
        参数1 数据类型[,参数2  数据类型]
        ……
            [,参数n 数据类型]
    ）
    RETURN 数据类型
    (IS|AS)
        声明参数;
    BEGIN
        执行语句段

    RETURN 参数;

    END;

#### 带有输入输出参数的函数创建

#### 删除函数

    DROP FUNCTION 函数名; 

### 存储过程
#### 什么是存储过程

存储过程是一种命名的PL/SQL程序块，它既可以没有参数，也可以有若干个输入、输出参数，甚至可以有多个既作输入又作输出的参数，但它没有RETURN返回值,如果需要输出值，可以通过OUT参数。

#### 不带参数存储过程的创建与使用

创建格式：

    CREATE OR REPLACE  PROCEDURE  过程名 AS
        声明语句段;
    BEGIN
        执行语句段;
    END;

调用方法：

    BEGIN
        过程名;
    END;

#### 带参数的存储过程的创建与使用

参数分类：输出参数、输入参数、双向参数

- IN：输入参数，主程序向过程传递参数值
- OUT：读出参数，过程像主程序传递参数值
- IN  OUT：双向参数，过程与主程序双向交流数据

创建格式：

    CREATE OR REPLACE PROCEDURE  过程名(
            参数1 [IN|OUT|IN OUT] 数据类型
            [,参数2[IN|OUT|IN OUT] 数据类型]
            ...
            [,参数n[IN|OUT|IN OUT]数据类型]
    )
    (IS|AS)
            声明语句段;
    BEGIN
            执行语句段;
    END;

调用方法：

    BEGIN
    过程名（参数，……）
    END;

#### 删除存储过程

    DROP PROCEDURE 存储过程名称；

### 存储函数与存储过程的区别

存储函数可以接受零个或多个输入参数，并且函数必须有返回值。

存储过程既可以没有参数，也可以有若干个输入、输出参数，甚至可以有多个既作输入又作输出的参数，但它可以没有返回值。


一般来讲，过程和函数的区别在于函数可以有一个返回值；而过程没有返回值。

但过程和函数都可以通过out指定一个或多个输出参数。我们可以利用out参数，

在过程和函数中实现返回多个值。

### 程序包

程序包是一组相关过程、函数、变量、常量和游标等PL/SQL程序设计元素的组合，作为一个完整的单元存储在数据库中，用名称来标识包。包类似于面向对象中的类，其中变量相当于类中的成员变量，过程和函数相当于类的方法。 

包中的程序元素分为公有元素和私有元素两种，它们允许访问的范围不同。公有元素不仅可以被包中的函数、过程所调用，也可以被包外的PL/SQL程序访问，而私有元素只能被包内的函数和过程所访问。

#### 创建程序包

##### 创建程序包声明 

创建程序包声明语法格式如下：

    CREATE [OR REPLACE] PACKAGE package_name  [IS|AS]
    package_specification
    END package_name;


其中的参数说明：
- package_name:指定包名
- package_specification:   列出了包可以使用的公共的过程、函数、类型和游标等。

##### 创建程序包主体

创建程序包的主体需要使用CREATE PACKEAGE BODY语句，其语法格式如下：

    CREATE [OR REPLACE] PACKAGE BODY package_name 
    [IS/AS]
    package_definition
    END package_name;

其中,package_definition表示程序包声明中列出的公共过程、函数、游标等的定义，具体实现。

#### 调用程序包中的元素

程序包内部的存储过程、函数及其他PL/SQL块，可以在包名后添加点（.）来调用。
    
其语法格式如下：

    package_name.[elemente_name]；

#### 删除程序包

    DROP PACKAGE package_name;